<div class='mt-4'>
	<div>
		<h3>
			Course management

		</h3>
		<a href='/me/trash/courses'>Restore deleted courses</a></div>

	<table class='table mt-4'>

		<thead class='thead-dark'>
			<tr>
				<th scope='col'>#</th>
				<th scope='col'>Course name</th>
				<th scope='col'>Description</th>
				<th scope='col'>Created At</th>
				<th scope='col'></th>
				<th scope='col'></th>

			</tr>
		</thead>
		<tbody>

			{{#each courses}}
				<tr>
					<th scope='row'>{{sum @index 1}}</th>
					<td>{{this.name}}</td>
					<td>{{this.description}}</td>
					<td>{{this.createdAt}}</td>
					<td>
						<a href='/courses/{{this._id}}/edit ' class='btn btn-primary'>Edit</a>

					</td>
					<td>
						<a
							type='button'
							class='btn btn-warning'
							data-toggle='modal'
							data-target='#deleteModal'
							data-id='{{this._id}}'
						>Delete</a>
					</td>
				</tr>
			{{else}}
				<tr>
					<td class='text-center' colspan='6'>No course is created.
						<a href='/courses/create'>Click here</a>
						to add course</td>
				</tr>
			{{/each}}

		</tbody>
	</table>

</div>

<!-- Modal to confirm delete course -->
<div
	class='modal fade'
	id='deleteModal'
	tabindex='-1'
	role='dialog'
	aria-labelledby='deleteModalLabel'
	aria-hidden='true'
>
	<div class='modal-dialog modal-dialog-centered' role='document'>
		<div class='modal-content'>
			<div class='modal-header'>
				<h5 class='modal-title' id='deleteModalLabel'>Are you sure?</h5>
				<button type='button' class='close' data-dismiss='modal' aria-label='Close'>
					<span aria-hidden='true'>&times;</span>
				</button>
			</div>
			<div class='modal-body'>
				Do you really want to delete the course? This action cannot be undone.
			</div>
			<div class='modal-footer'>
				<a type='button' class='btn btn-danger' id='btn-delete-confirm'>DELETE</a>
				<button type='button' class='btn btn-secondary' data-dismiss='modal'>CANCEL</button>

			</div>
		</div>
	</div>
</div>

{{! Hidden form to confirm delete course }}
<form name='deleteForm' method='POST' action='/courses/{{course._id}}?_method=DELETE'></form>

<script>
	var courseId; var deleteForm = document.forms['deleteForm'];
	document.addEventListener('DOMContentLoaded', function() { $('#deleteModal').on('show.bs.modal',
	function (event) { var button = $(event.relatedTarget) 
	courseId = button.data('id')

	$('#btn-delete-confirm').click(function() { deleteForm.action =
	`/courses/${courseId}?_method=DELETE`;
	  deleteForm.submit(); }) 
	
	}) })

</script>